-- CRIAÇÃO DA TABELA DE USUARIOS DO SISTEMA
CREATE TABLE USUARIOS (
	USER_NAME			VARCHAR(50) NOT NULL,
	PASSWD				VARCHAR(255) NOT NULL,
	NOME_COMP			VARCHAR(100) NOT NULL,
	CONSTRAINT 			PK_USUARIOS PRIMARY KEY(USER_NAME)
);
INSERT INTO USUARIOS (USER_NAME, PASSWD, NOME_COMP) VALUES ('admin', '21232f297a57a5a743894a0e4a801fc3', 'Administrador do sistema');

-- CRIAÇÃO DA TABELA DE PRODUTOS
CREATE TABLE PRODUTO (
	COD_PRODUTO 		INTEGER NOT NULL,
  	DESCRICAO 			VARCHAR(100) NOT NULL,
  	CONSTRAINT 			PK_PRODUTO PRIMARY KEY(COD_PRODUTO)
);

-- CRIAÇÃO DA TABELA DE PREVISÃO
CREATE TABLE PREVISAO (
  	COD_PREVISAO 		INTEGER NOT NULL AUTO_INCREMENT,
  	DESCRICAO 			VARCHAR(100) NOT NULL,
  	CONSTRAINT 			PK_PREVISAO PRIMARY KEY(COD_PREVISAO)
);

-- CRIAÇÃO DA TABELA DE UF
CREATE TABLE UNIDADE_FEDERATIVA (
    COD_UF      		INTEGER NOT NULL,
    DESCRICAO   		VARCHAR(100) NOT NULL,
    SIGLA       		VARCHAR(2) NOT NULL,
    CONSTRAINT 			PK_UNIDADE_FEDERATIVA PRIMARY KEY (COD_UF)
);

-- CRIAÇÃO DA TABELA DE MUNICÍPIO
CREATE TABLE MUNICIPIO (
    COD_MUNICIPIO 		INTEGER NOT NULL,
    DESCRICAO   		VARCHAR(100) NOT NULL,
    COD_UF      		INTEGER NOT NULL,
    CONSTRAINT  		PK_MUNICIPIO PRIMARY KEY (COD_MUNICIPIO),
    CONSTRAINT  		FK_MUNICIPIO_UNIDADE_FEDERATIVA FOREIGN KEY (COD_UF) REFERENCES UNIDADE_FEDERATIVA(COD_UF)
);

-- CRIAÇÃO DA TABELA DE ENDEREÇOS
CREATE TABLE ENDERECO (
  	COD_ENDERECO 		INTEGER NOT NULL AUTO_INCREMENT,
  	LOGRADOURO 			VARCHAR(100) NOT NULL,
  	NUMERO 				INTEGER NOT NULL,
  	BAIRRO 				VARCHAR(100) NOT NULL,
  	CEP 				INTEGER NOT NULL,
  	MUNICIPIO 			INTEGER NOT NULL,
  	CONSTRAINT 			PK_ENDERECO PRIMARY KEY (COD_ENDERECO),
  	CONSTRAINT 			FK_ENDERECO_MUNICIPIO FOREIGN KEY (MUNICIPIO) REFERENCES MUNICIPIO(COD_MUNICIPIO)
);

-- CRIAÇÃO DA TABELA DE TERRENOS
CREATE TABLE TERRENO (
  	COD_TERRENO 		INTEGER NOT NULL,
  	DESCRICAO 			VARCHAR(250) NOT NULL,
  	ENDERECO 			INTEGER NOT NULL,
  	VALOR_VENDA 		DECIMAL(10,2) NOT NULL,
  	METRAGEM 			DECIMAL(10,0) NOT NULL,
  	VALOR_ITBI 			DECIMAL(10,2) NOT NULL,
  	VALOR_FRJ 			DECIMAL(10,2) NOT NULL,
  	VALOR_ESCRITURA 	DECIMAL(10,2) NOT NULL,
  	VALOR_REGISTRO 		DECIMAL(10,2) NOT NULL,
  	CONSTRAINT 			PK_TERRENO PRIMARY KEY(COD_TERRENO),
  	CONSTRAINT 			FK_TERRENO_ENDERECO FOREIGN KEY (ENDERECO) REFERENCES ENDERECO(COD_ENDERECO)
);

-- CRIAÇÃO DA TABELA PESSOA
CREATE TABLE PESSOA (
  	COD_PESSOA 			INTEGER NOT NULL,
  	ENDERECO 			INTEGER NOT NULL,
  	TIPO_PESSOA 		CHAR(1) NULL,
  	NOME_PESSOA 		VARCHAR(100) NOT NULL,
  	SOBRENOME_PESSOA 	VARCHAR(100) NOT NULL,
  	RAZAO_SOCIAL 		VARCHAR(100),
  	NOME_FANTASIA 		VARCHAR(100),
  	DOCUMENTO 			BIGINT NOT NULL,
  	CONSTRAINT 			PK_PESSOA PRIMARY KEY(COD_PESSOA),
  	CONSTRAINT 			PESSOA_ENDERECO FOREIGN KEY (ENDERECO) REFERENCES ENDERECO(COD_ENDERECO),
  	CONSTRAINT 			UK_PESSOA UNIQUE KEY (DOCUMENTO)
);

-- CRIAÇÃO DA TABELA DE ORÇAMENTOS
CREATE TABLE ORCAMENTO (
  	COD_ORCAMENTO 			INTEGER NOT NULL AUTO_INCREMENT,
  	CLIENTE 				INTEGER NOT NULL,
  	TERRENO 				INTEGER NOT NULL,
  	NOME 					VARCHAR(100) NOT NULL,
  	DESCRICAO 				VARCHAR(100) NOT NULL,
  	CUSTO_UNITARIO_BASICO 	INTEGER NOT NULL,
  	METRAGEM_CONSTRUCAO 	DECIMAL(10,2) NOT NULL,
  	PERCENTUAL_LUCRO 		DECIMAL(10,2) NOT NULL,
  	CONSTRAINT 				PK_ORCAMENTO PRIMARY KEY (COD_ORCAMENTO),
  	CONSTRAINT 				FK_ORCAMENTO_PESSOA FOREIGN KEY (CLIENTE) REFERENCES PESSOA(COD_PESSOA),
  	CONSTRAINT				FK_ORCAMENTO_TERRENO FOREIGN KEY (TERRENO) REFERENCES TERRENO(COD_TERRENO),
  	CONSTRAINT				FK_ORCAMENTO_CUB FOREIGN KEY (CUSTO_UNITARIO_BASICO) REFERENCES CUB(COD_CUB)
);

-- CRIAÇÃO DA TABELA DE CUSTO REAL
CREATE TABLE CUSTO_REAL (
  	COD_CUSTOREAL 		INTEGER NOT NULL AUTO_INCREMENT,
  	PRODUTO 			INTEGER NOT NULL,
  	PREVISAO 			INTEGER NOT NULL,
  	ORCAMENTO 			INTEGER NOT NULL,
  	CONSTRAINT 			PK_CUSTO_REAL PRIMARY KEY (COD_CUSTOREAL),
  	CONSTRAINT 			FK_CUSTO_REAL_PRODUTO FOREIGN KEY (PRODUTO) REFERENCES PRODUTO(COD_PRODUTO),
  	CONSTRAINT 			FK_CUSTO_REAL_PREVISAO FOREIGN KEY (PREVISAO) REFERENCES PREVISAO(COD_PREVISAO),
  	CONSTRAINT 			FK_CUSTO_REAL_ORCAMENTO FOREIGN KEY (ORCAMENTO) REFERENCES ORCAMENTO(COD_ORCAMENTO)
);

-- CRIAÇÃO DA TABELA DE ORCAMENTO_PREVISAO
CREATE TABLE ORCAMENTO_PREVISAO (
	COD_ORC_PREV 		INTEGER NOT NULL AUTO_INCREMENT,
	PREVISAO 			INTEGER NOT NULL,
	ORCAMENTO 			INTEGER NOT NULL,
	VALOR 				DECIMAL(10,2) NOT NULL,
	CONSTRAINT 			PK_COD_ORC_PREV PRIMARY KEY (COD_ORC_PREV),
	CONSTRAINT 			FK_ORCAMENTO_PREVISAO_PREVISAO FOREIGN KEY (PREVISAO) REFERENCES PREVISAO(COD_PREVISAO),
  	CONSTRAINT 			FK_ORCAMENTO_PREVISAO_ORCAMENTO FOREIGN KEY (ORCAMENTO) REFERENCES ORCAMENTO(COD_ORCAMENTO)
);

-- CRIAÇÃO DA TABELA DE CUSTO UNITARIO BASICO
CREATE TABLE CUB (
	COD_CUB				INTEGER NOT NULL AUTO_INCREMENT,
	ANO					INTEGER NOT NULL,
	MES					INTEGER NOT NULL,
	VL_METRO_QUADRADO	DECIMAL(10,2) NOT NULL,
	CONSTRAINT			PK_CUB PRIMARY KEY (COD_CUB),
	CONSTRAINT			UK_CUB UNIQUE KEU (ANO, MES) 			
);
